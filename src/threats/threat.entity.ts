/* eslint-disable prettier/prettier */
import { BaseEntity, Column, Entity, PrimaryGeneratedColumn } from 'typeorm';
import { Ioc, Malware, ThreatFiled } from './data/threats.interface';
import { ThreatStatus } from './threat-status.enum';

@Entity()
export class Threatent extends BaseEntity {
  @PrimaryGeneratedColumn('uuid')
  threaduid: string;

  @Column()
  name: string; //Прост строка парсится из названия или первой строки файла

  @Column('jsonb')
  public cve!: ThreatFiled[]; // Всей найденные све (чаще всего будет только 1)

  @Column('jsonb')
  public cwe!: ThreatFiled[]; // Все найденые све

  @Column('jsonb')
  public software!: Malware[]; // Все зараженные софты (не факт что сможем отличать вредоносов от софтвейр)

  @Column('jsonb')
  public malware!: Malware[]; // Все вредоносы и инфа по ним

  @Column('jsonb')
  public threatActor!: ThreatFiled[]; // Киберпреступные групировки и ссылки на параграфы где их имена встречались

  @Column('jsonb')
  public industry!: ThreatFiled[]; // Индустрии и параграфы где они указаны

  @Column('jsonb')
  public mitreAattack!: ThreatFiled[]; // Атаки и параграфы где они указаны

  @Column('jsonb')
  public county!: ThreatFiled[]; // Страны и параграфы где они указаны

  @Column('jsonb')
  public city!: ThreatFiled[]; // Города (опционально)

  @Column('jsonb')
  public timeStamp!: ThreatFiled[]; // Тут сложнее, но как минимум будет список дат и параграфы где они указаны

  @Column('jsonb')
  ioc: Ioc; // вернет отформатированный тхт документ, не уверен надо ли это

  @Column()
  rating: string; // от 0 до 10

  @Column()
  comment: string;

  @Column()
  status: ThreatStatus;
}
